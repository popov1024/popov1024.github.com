<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>1c on Andrey Popov</title>
    <link>https://popov.by/tags/1c/</link>
    <description>Recent content in 1c on Andrey Popov</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ru-Ru</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Mon, 09 May 2016 00:00:00 +0300</lastBuildDate>
    <atom:link href="https://popov.by/tags/1c/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>TeamCity 1C:Enterprise 8</title>
      <link>https://popov.by/post/teamcity-1c-enterprise-8/</link>
      <pubDate>Mon, 09 May 2016 00:00:00 +0300</pubDate>
      
      <guid>https://popov.by/post/teamcity-1c-enterprise-8/</guid>
      <description>

&lt;h3 id=&#34;преамбула&#34;&gt;Преамбула&lt;/h3&gt;

&lt;p&gt;Для автоматизации сборки конфигураций 1С:Предприятие 8 написал &lt;a href=&#34;https://github.com/popov1024/1CTeamCity&#34;&gt;скрипты&lt;/a&gt; на PowerShell для &lt;a href=&#34;https://www.jetbrains.com/teamcity/&#34;&gt;TeamCity&lt;/a&gt; (TC).&lt;/p&gt;

&lt;p&gt;Это уже не первый мой опыт: в текущее время использую написанный мною на Ant сценарий, который верой и правдой собирает для версии платформы 8.2.&lt;/p&gt;

&lt;p&gt;Что сподвигло к изменениям?&lt;/p&gt;

&lt;p&gt;Прежде всего это выход платформы 8.3.6 в которой появилась возможность подключать конфигурацию в хранилищу. Т.е. позволяет автоматизировать создания сборки с нуля новых проектов.&lt;/p&gt;

&lt;p&gt;Во-вторых, я организовал теперь все в виде шаблонов для TC с минимальным набором параметров сборки.&lt;/p&gt;

&lt;p&gt;Сам процесс сборки подразумевает следующий порядок хранения:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;...
builds\1.1.0\
builds\1.1.0\1.1.0.1
builds\1.1.0\1.1.0.2
builds\1.1.0\1.1.0.3
...
builds\1.1.1\
builds\1.1.0\1.1.0.3
builds\1.1.0\1.1.1.1
builds\1.1.0\1.1.1.2
builds\1.1.0\1.1.1.3
...
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;как-настраивать&#34;&gt;Как настраивать&lt;/h3&gt;

&lt;h5 id=&#34;создание-шаблона&#34;&gt;Создание шаблона&lt;/h5&gt;

&lt;p&gt;Я организовал все в виде шаблонов для корневого проекта.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://popov.by/images/allposts/Root_project-1cTeamCity.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Данный шаблон содержит набор шагов сборки:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;создание (&lt;a href=&#34;https://github.com/popov1024/1CTeamCity/blob/master/Build/Create.ps1&#34;&gt;Build/Create.ps1&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;обновление (&lt;a href=&#34;https://github.com/popov1024/1CTeamCity/blob/master/Build/Update.ps1&#34;&gt;Build/Update.ps1&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;сама сборка (&lt;a href=&#34;https://github.com/popov1024/1CTeamCity/blob/master/Build/Build.ps1&#34;&gt;Build/Build.ps1&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Каждый шаг я сделал в следующем виде:
&lt;img src=&#34;https://popov.by/images/allposts/1C83_Build_Template-1cTeamCity.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Я предпочитаю использовать тип сценария &lt;code&gt;Source code&lt;/code&gt;, так как в данном случае TC сам определяет все параметры сборки (указаны в виде шаблона %&amp;hellip;%) и проще вносить корректировки.&lt;/p&gt;

&lt;p&gt;Параметры можно определить значениями по умолчанию.
&lt;img src=&#34;https://popov.by/images/allposts/1C83_Build_Template.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;настройка-агента&#34;&gt;Настройка агента&lt;/h4&gt;

&lt;p&gt;В настройках самого агента сборки я прописываю пути к исполняемым файлам платформы, которые в последствие используются в сценарии.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://popov.by/images/allposts/Agent_Parameters-1cTeamCity.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Пример настройки агента &lt;code&gt;BuildAgent\conf\buildAgent.properties&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;env.1cbin_8_3=C:\\Program Files (x86)\\1cv8\\8.3.8.1652\\bin\\1cv8.exe
env.1cbin_8_3_8=C:\\Program Files (x86)\\1cv8\\8.3.8.1652\\bin\\1cv8.exe
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;создание-проекта&#34;&gt;Создание проекта&lt;/h4&gt;

&lt;p&gt;Теперь любой новый создаваемый проект сборки можно указать что он будет основан на необходимом шаблоне.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://popov.by/images/allposts/Build_Configuration-1cTeamCity.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Все параметры можно переопределять в соотвествии с проектом.&lt;/p&gt;

&lt;p&gt;Если все сделано корректно, то процесс сборки будет сводиться к следующему виду.
&lt;img src=&#34;https://popov.by/images/allposts/Projects-1cTeamCity.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Полученный артефакты в результате сборки (&lt;code&gt;1cv8.cf&lt;/code&gt; и &lt;code&gt;1cv8.cfu&lt;/code&gt;) в случае успеха добавятся к сборке.
&lt;img src=&#34;https://popov.by/images/allposts/Build_-1cTeamCity.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>